<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:ws="http://jax-ws.dev.java.net/spring/core"
	xmlns:wss="http://jax-ws.dev.java.net/spring/servlet"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:aop="http://www.springframework.org/schema/aop"
	xmlns:p="http://www.springframework.org/schema/p"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:jee="http://www.springframework.org/schema/jee"
	xmlns:tx="http://www.springframework.org/schema/tx"
	xsi:schemaLocation="
          http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd
		  http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd 
          http://jax-ws.dev.java.net/spring/core http://jax-ws.dev.java.net/spring/core.xsd 
          http://jax-ws.dev.java.net/spring/servlet http://jax-ws.dev.java.net/spring/servlet.xsd
          http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd
    	  http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-2.5.xsd
		  http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd">

	<!-- ========================= RESOURCE DEFINITIONS ========================= -->
	<bean id="propertyConfigurer"
		class="org.kuali.student.poc.common.util.ModPropertyPlaceholderConfigurer">
		<property name="locations">
			<list>
				<value>classpath:maven-config.properties</value>
				<value>classpath:META-INF/default-test.properties</value>
				<value>classpath:META-INF/default-test-override.properties</value>
			</list>
		</property>
	</bean>
	
	<bean name="client" class="org.kuali.student.poc.common.ws.beans.JaxWsClientFactoryBean" depends-on="server">
		<property name="serviceEndpointInterface" value="${ks.test.serviceInterface}"/>
		<property name="wsdlDocumentLocation" value="http://localhost:${ks.test.port}/Service/Service?wsdl"/>
		<property name="serviceNamespaceURI" value="${ks.test.serviceNamespace}"/>
		<property name="serviceName" value="${ks.test.serviceName}"/>
	</bean>

	<bean name="server" class="org.mortbay.jetty.Server"
		init-method="start" destroy-method="stop">
		<constructor-arg value="${ks.test.port}" />

		<property name="handler">
			<bean id="handlers"
				class="org.mortbay.jetty.handler.HandlerCollection">

				<property name="handlers">
					<list>
						<!-- order is very important here; the contexts should come before anything else -->
						<bean id="contexts"
							class="org.mortbay.jetty.handler.ContextHandlerCollection">

							<property name="handlers">
								<list>
									<bean
										class="org.mortbay.jetty.servlet.Context">
										<property name="contextPath"
											value="/Service" />
										<property name="resourceBase"
											value="src/test/resources" />
										<property name="initParams">
											<map>
												<entry
													key="contextConfigLocation"
													value="classpath:META-INF/${ws.engine}-context.xml" />
												<entry
													key="log4jConfigLocation" value="log4j.properties" />
											</map>
										</property>
										<property
											name="eventListeners">
											<list>
												<bean
													class="org.springframework.web.context.ContextLoaderListener" />
											</list>
										</property>
										<property
											name="servletHandler">
											<bean
												class="org.mortbay.jetty.servlet.ServletHandler">
												<property
													name="servlets">
													<list>
														<bean
															class="org.mortbay.jetty.servlet.ServletHolder">
															<property
																name="name" value="Service" />
															<property
																name="servlet">
																<bean
																	class="${ws.servlet}" />
															</property>
														</bean>
													</list>
												</property>
												<property
													name="servletMappings">
													<list>
														<bean
															class="org.mortbay.jetty.servlet.ServletMapping">
															<property
																name="servletName" value="Service" />
															<property
																name="pathSpec" value="/*" />
														</bean>
													</list>
												</property>
											</bean>
										</property>
									</bean>
								</list>
							</property>
						</bean>
					</list>
				</property>
			</bean>
		</property>
	</bean>
</beans>

package org.kuali.student.rules.course_co_req.Intermediate_CPR
import java.util.*;
import org.kuali.student.rules.statement.*;
import org.kuali.student.rules.common.util.CourseEnrollmentRequest;

rule "Intermediate_CPR_INIT"
    salience 2147483647
    no-loop true
    lock-on-active true
    when
        //prop: PropositionContainer(size == 0)
        prop : PropositionContainer()
        req: CourseEnrollmentRequest()
    then
        SubsetProposition propositionA = new SubsetProposition("A", ComparisonOperator.EQUAL_TO, "1", new HashSet(Arrays.asList("CPR101".split("\\s*,\\s*"))),  req.getLuiIds() );
        propositionA.apply();
        prop.addProposition(propositionA);

        SubsetProposition propositionB = new SubsetProposition("B", ComparisonOperator.EQUAL_TO, "1", new HashSet(Arrays.asList("CHEM101".split("\\s*,\\s*"))),  req.getLuiIds() );
        propositionB.apply();
        prop.addProposition(propositionB);

        update(prop);
end

rule "Intermediate_CPR"
    //salience -100
    when
        prop : PropositionContainer(size == 2)
        
        Proposition( propositionName == "A" && result == true ) from prop.propositions
        or
        Proposition( propositionName == "B" && result == true ) from prop.propositions

        //eval (
        //    ( //prop.getProposition("A") != null &&
        //    prop.getProposition("A").getResult() )
        //    ||
        //    ( //prop.getProposition("B") != null &&
        //    prop.getProposition("B").getResult() )
        //)
    then
        //System.out.println( "list=" + list );
        //for( int i=0; i<list.size(); i++ ) {
            //System.out.println( "list=" + list.get( i ).getPropositionName() ); 
        //}
        prop.setRuleResult(true);
end
